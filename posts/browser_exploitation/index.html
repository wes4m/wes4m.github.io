<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>إستغلال ثغرات المتصفح | Webbrowser exploitation | wes4m</title>
<meta name=keywords content="Misc">
<meta name=description content="Part 1">
<meta name=author content="wes4m">
<link rel=canonical href=https://wes4m.io/posts/browser_exploitation/>
<link crossorigin=anonymous href=/assets/css/stylesheet.c266585e349dd9ce670351e0239f03ee0ebc4ca57cc47e0fd0d98f00e50aee7e.css integrity="sha256-wmZYXjSd2c5nA1HgI58D7g68TKV8xH4P0NmPAOUK7n4=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wes4m.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://wes4m.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://wes4m.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://wes4m.io/apple-touch-icon.png>
<link rel=mask-icon href=https://wes4m.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<script src=/dist/webcomponents-loader.js></script>
<script src=/dist/gif-player.es6.js defer async></script>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X4Z7CWYY5B"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-X4Z7CWYY5B',{anonymize_ip:!1})}</script>
<meta property="og:title" content="إستغلال ثغرات المتصفح | Webbrowser exploitation">
<meta property="og:description" content="Part 1">
<meta property="og:type" content="article">
<meta property="og:url" content="https://wes4m.io/posts/browser_exploitation/">
<meta property="og:image" content="https://wes4m.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-11-25T04:51:01-07:00">
<meta property="article:modified_time" content="2019-11-25T04:51:01-07:00"><meta property="og:site_name" content="wes4m">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://wes4m.io/%3Cimage%20path/url%3E">
<meta name=twitter:title content="إستغلال ثغرات المتصفح | Webbrowser exploitation">
<meta name=twitter:description content="Part 1">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wes4m.io/posts/"},{"@type":"ListItem","position":2,"name":"إستغلال ثغرات المتصفح | Webbrowser exploitation","item":"https://wes4m.io/posts/browser_exploitation/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"إستغلال ثغرات المتصفح | Webbrowser exploitation","name":"إستغلال ثغرات المتصفح | Webbrowser exploitation","description":"Part 1","keywords":["Misc"],"articleBody":" تنويه: إستغلال ثغرات المتصفحات ليس من إختصاصي إنما هذه السلسلة عبارة عن تدوين مستمر لطريقي في خوض هذا المجال وتعزيز لفهمي. أي اغلاط او اضافات أكون شاكر لكم. ملاحظة: إطلاع سابق وفهم كيفية عمل لغات البرمجة. والـ Interpreters بشكل سطحي مهمة جدآ لهذا الموضوع.\n قبل الخوض في إستغلال ثغرات المتصفحات يجب أن نكون على إطلاع بأن المتصفحات في هذا الوقت أصبحت من أضخم وأهم البرمجيات قد توازي في تعقيدها أنظمة التشغيل نظرآ لتكونها من عناصر عديدة مترابطة ومعقدة. وكل ما إزداد التعقيد وحجم الكود برمجيآ كل ما إتسع الـ Attack surface. فعلى سبيل المثال عندما ترغب بالعثور على ثغرة وإستغلالها في نظام تشغيل ما. يجب عليك تحديد نظام التشغيل ومن ثم تحديد الجزء الذي ترغب في تحليله ودراسته للعثور على ثغرات. كذلك في المتصفحات.\nيتكون المتصفح في هذا الوقت من عدة أجزاء Components أهمها ( ليست محصورة ) :\n UI: واجهة المستخدم Renderer engine: فلابد من جزء مسؤول عن تحويل أكواد الصفحات من عدة لغات مثل html, css لكي يراها المستخدم. Networking: الجزء المسؤول عن كل مايتعلق بالشبكة وإرسال الطلبات وغيرها. Javascript engine: المحرك المسؤول عن كل مايتعلق بالـ Javascript وتنفيذها للمستخدم. Sandboxing. IPC: من أهم الاجزاء التي تعتبر جزء مسؤول عن حماية المستخدم حتى بعد وجود ثغرات. وغيرها الكثير ..  كل جزء يعتبر ضخم ومتفرع جدآ وقابل للإستغلال بشكل أو بآخر. ويوجد من يكرس كامل دراسته في جزء واحد فقط من هذه الأجزاء. في هذه السلسلة سيكون تركيزي على الـ Javascript engine وكيفية إستغلال ثغراته.\nتوجد عدة متصفحات ولكل متصفح الـ Javascript engine الخاص به عادتآ. أمثلة على ذلك:\n Safari: JavascriptCore Google Chrome: V8 Microsoft Edge: ChakraCore Firefox: SpiderMonkey  مقدمة عن Javascript engines هل سبق وسألت نفسك كيف يقوم المتصفح بتنفيذ أكواد الـ javascript بسرعة عالية ؟ ومدى أهمية السرعة في المتصفحات أو لماذا لايقوم مصممي المواقع بعمل Compile لأكواد الـ javascript وتضمينها مع صفحاتهم.\nتوجد عدة أسباب أهمها الحجم، السرعة، والحرية في التواصل مع العناصر الإخرى في الصفحة إن صح التعبير. فعادتآ اكواد الجافاسكربت مرتبطة بالـ DOM في الصفحة وتتعامل مع الـ Renderer engine لإضافة نصوص وقرائتها والحصول على معطيات من المستخدم وربطها بـ Events كضغط أزرار أو تغيير اللوان CSS وغيرها من ترابطات بين كل أجزاء الصفحة.\nيمكنك دراسة الـ Javascript engine بشكل عام والقراءة عنه وغيره .. لكن لإستغلاله لابد من إختيار محرك محدد والتعمق فيه. وقع إختياري على ChakreCore مفتوح المصدر ومن هنا تبدأ الرحلة.\nChakraCore ChakraCore هو أساس محرك Chakra وهو الجزء المسؤول عن الـ javascript في متصفح Microsoft Edge يتكون المحرك من عدة أجزاء قابلة للإستغلال ومعقدة كذلك ولكن سيكون تركيزي على جزء واحد فقط.\nالجافاسكربت هي لغة برمجة كغيرها من اللغات فلو قمت بدراسة كيف تعمل لغة برمجة بشكل مبسط سترى أنك بحاجة الى Parser يقوم بتحويل الكود المكتوب الى Abstract Syntax Tree - AST يمكنك التعمق في هذا الموضوع (يدرس عادتآ في كلاسات علوم الكمبيوتر) ومن ثم على حسب نمط اللغة ستحتاج الى Interpret/Compiler أو الاثنان معآ.\nبالإضافة لذلك تجد في الصورة عدة أجزاء إضافية مثل Garbage collector الجزء المسؤول عن تنظيف الذاكرة بشكل تلقائي. على عكس لغات إخرى قد لاتحتوي على هذا الجزء مثل C. وكل جزء من هذه الأجزاء أيضآ معقد ويتفرع بداخله لعدة أجزاء.\nبإختصار شديد، فور فتحك لصفحة تحتوي على أكواد جافاسكربت يبدأ المحرك بالعمل وقراءة الكود قبل حتى أن تعرض الصفحة لك\n(Execution Pipeline) مسار تنفيذ الـ Javascript في ChakraCore: الخطوة الإولى: تحويل الكود الى AST يقوم بفهمها الـ Bytecode generator فهذه هي طريقة عمل لغة برمجة الجافا بشكل عام. يتم تحويل الكود الـ Bytecode تستطيع فهمه الـ Java virtual machine - JVM وتنفيذه.\nالخطوة الثانية: يقوم الـ Interpreter بتنفيذ أو الأصح Interpret للـ Bytecode في ثريد منفصل وأثناء تنفيذه يقوم بجمع معلومات عن كل سطر يقوم بتنفيذه ومن هنا يأتي مصطلح Profiling المضاف في الصورة. على سبيل المثال كما تعلم ففي الجافاسكربت يمكنك إسناد رقم الى متغير أو نص بدون تحديد نوع المتغير فهنا يأتي دور الـ Profiler فيقوم بتخزين المعلومة أن المتغير من نوع Integer  على سبيل المثال. وكذلك غيرها من المعلومات.\nالخطوة الثالثة: كما تحدثنا سابقآ فأهم عنصر في الجافاسكربت هي السرعة. المستخدم يريد أن تعمل الصفحة بسلاسة وتتحمل بأسرع وقت ممكن هنا يأتي دور الـ Just In time compiler - JIT وهو الجزء الذي سيكون كامل تركيزي عليه.\nماهو JIT ؟ هو جزء مسؤول عن إستخدام المعلومات المجموعة عن طريق الـ Profiling Interpreter وإستخدامها في صالح عمل Optimization للكود. بحيث يتم تنفيذه بشكل أسرع. للعلم أنه يمكنك عمل compile للجافاسكربت Ahead of time - AOT كغيرها من اللغات. ولكن الضعف في عمل compile مسبق بأن الكود سيصبح بطيئ وضخم نظرآ للتحققات التي يجب أن تضاف قبل كل سطر على سبيل المثال إسناد متغير ومن ثم جمعه مع متغير آخر\n قد ترى الكود بسيط ولكن في الخلفية وعند تحويل الكود الى Machine code إضافة رقم الى رقم ليس كإضافة نص الى رقم. لنفرض أن b = 2 غيرناه الى رقم بدل عن نص. كيف يمكن للـ Interpreter معرفة ذلك بدون وضع تعليمات إضافية للتحقق من كل متغير قبل تنفيذ عمليات عليه. ومن هذا المنطلق تأتي الحاجة للـ Optimization خصوصا لو كانت عملية مكررة كحلقات التكرار. فالتعليمات الإضافية للتحقق من نوع المتغير أو حجم مصفوفة أو غيره الكثير من الحالات تؤدي الى بطئ وإضاعة وقت و موارد الجهاز وهذا الإهذار يعتبر عدو من أعداء علماء الكمبيوتر فالكثير الكثير من الخوارزميات والتكنلوجيا كانت نتيجة عن بحوث في الـ Optimization\nوفي حالة الـ javascript engines هنا يولد الـ JIT فبإستخدام المعلومات من الـ Profiling يمكن للـ JIT إستنباط إمور كثيرة كنوع المتغير، حجمه، حجم المصفوفات والـ Objects وانواعهم وغيرها الكثير من الامور .. بإستنباط هذه المعلومات يمكنه إتخاد قرار على سبيل المثال أن الكود يقوم بتنفيذ حلقة تكرار ويضيف متغيرين من نوع Integer في كل مرة. فبدوره يقوم بإنتاج Machine code لايقوم بالتحقق من نوع المتغير في كل مرة فيكفي التحقق مرة واحدة ومن ثم تنفيذ الكود. هذا أحد الأمثلة على عمل Optimization وتسريع الكود. قد يفشل التحقق الأول وبدوره يعود الى الكود السابق الأساسي في عملية تسمى Bail out. ولكن أيضا قد يفشل بشكل غير متوقع أو مقصود ( وهنا تكمن الثغرات، فيمكنك إستغلال عدة أنواع ثغرات في الـ JIT )\nكما نرى في الصورة ينقسم الـ JIT في ChakraCore الى قسمين SimpleJIT و FullJIT كل جزء مسؤول عن عمل Optimization ولكن الـ FullJIT هو الجزء الأهم في المحرك نظرآ لأنه يقوم بعمل الجزء الاكبر والاكثر تعقيدآ من التغييرات وسيكون تركيزي متمحور حوله بشكل كامل. ولكن قبل ذلك لابد من التعمق بشكل أكبر في ChakraCore\n ملاحظة قد تختلف المسميات لأجزاء كل محرك ويختلف الـ implementation ولكن بشكل عام التشابه كبير والوظيفة واحدة. على سبيل المثال الـ JIT في محرك قوقل كروم V8 يسمي TurboFan\n بعض المعلومات المهمة في ChakraCore لايمكننا الخوض في طريقة عمل الـ JIT وكيفية إستغلاله قبل أن نعرف عدة إمور منها كيف يقوم ChakraCore بتخزين البيانات من Values, Objects وغيرها في الذاكرة. فتحدثت سابقآ أنه لابد من التحقق من المتغيرات قبل تنفيذ عملية عليها نظرآ لإختلاف طريقة تنفيذ العمليات والتعامل مع values من أنواع مختلفة.\nقمت بتحميل ChakraCore على Linux من هنا: https://github.com/microsoft/ChakraCore وعمل build له للبدء في التعمق فيه وفهم بعض من طرق عمله.\n بعض المحركات الإخرى مثل JavascriptCore نوعآ ما أسهل في عمل debugging والتعمق فيها بسبب توفر عدة functions و interactive cli له.\nكذلك سأقوم بإستخدام gdb على linux لأنها الـ environment المفضلة لدي قد أكون صعبت على نفسي العملية\n  إستخدام windbg وتحميل المحرك على windows لربما يكون أسهل في التعامل معه. بما معناه: لاتتابعني إستخدم ويندوز أسهل 🤗\n إضافة functions للسورس تساعد على عمل debugging قمت بإضافة بعض الfunctions لسورس المحرك لتسهيل فحص الذاكرة وإضافة breakpoints\n   بعد الإضافة وعمل build يمكن إستخدام الـ functions في كود الجافاسكربت وتشغيله عن طريق الـ ch بإستخدام gdb على سبيل المثال\n الملف الناتج ch في out/Debug/ch يحتوي على إمكانيات كثيرة جدآ من ضمنها طباعة الكود بعد Phase محدد في المحرك على سبيل المثال يمكنه عرض الكود بعد تحويله الى ByteCode عن طريق الأمر\nch -dump:Bytecode test.js كذلك تعطيل Phase محدد وطباعة بعض العنوانين عن طريق\n وغيرها الكثير ..\nJSValues لنرى كيف يقوم المحرك بتخزين بعض البيانات في الذاكرة. بدئآ بـ Integers\n قمت بطباعة الـ ByteCode وأيضا تتبع الـ Interpreter في gdb وكانت هذه الملاحظات:\n الصورة بحجم أكبر من هنا  الملاحظات:\n 1: نرى أن الرقم 0x414141 يتم تخزينه كثابت const في R3 عن طريق LdC_A_I4 ويبدوا أنه I4 ترمز الى integer من أربع بايتات 2: يتم إسناد الثابت من R3 الى المتغير root.a وهو المتغير في الكود عن طريق ProfiledStRootFld 3: عن طريق تتبع الـ Interpreter وصولآ الى التعليمة ProfiledStRootFld وتتبعها ستلاحظ أن الرقم سيظهر في RSI وثم يتم نقله الى عنوان بالذاكرة وهو عنوان المتغير. ولكن ستلاحظ أيضا أن الرقم أصبح بهذا الشكل:  0x 00 01 00 00 00 41 41 41 ولو تركنا الكود يكمل تنفيذه سنرى النتيجة كالتالي أيضآ\nAddress/val 1th arg: 0x1000000414141 مما يأكد النتيجة. مما يعني أن المحرك يقوم بتخزين الرقم في الاربع بايتات السفلية ويقوم بإستخدام 0x00010000 في الاربع بياتات العلوية كمعلومة أن هذا المتغير من نوع Integer\nعند تجربة NULL ستلاحظ أن النتيجة 0x0000000000000000 عند التجربة على float النتيجة مختلفة قليلآ قد يبدو أنك لاتجد الرقم الذي وضعته ولكن مايحدث هو أن المحرك يقوم بعمل XOR للـ float المدخل مع 0xfffc000000000000. وتوجد بعض المعلومات الإخرى كـ infinity و -infinity ولهم رقم خاص يمكنك الإطلاع على هذا الموضوع لمعرفة أكثر عن الـ floats في ChakraCore:\nhttps://abchatra.github.io/TaggedFloat\nوبهذه الآلية والتجربة يمكنك ملاحظة بقية أنواع المتغيرات.\nJSObjects في الجافاسكربت أغلب ماتتعامل معه هو عبارة عن Object حتى الـ functions فأي عنصر ليس\nPrimitive type - undefined, null, number, string, boolean فهو Object\nمن سورس كود المحرك نرى أن الـ Object في الذاكرة يكون بهذا الشكلDynamicObject.h\n حاليآ لايهمنا سوى الـ auxSlots, inline slots فالـ Objects في الجافاسكربت لايتم تخزين الـ keys التابعة لها في الاوبجكت نفسه بل يتم تخزينه كـ Type يمكن إستخدامه عن طريق عدة Objects ويتم إدارته عن طريق الـ DynamicTypeHandler الـ type يوجد مباشرة بعد عنوان الـ vtable\nصورة توضيحية: لمعلومات أكثر عن الـ Type في ChakraCore: https://abchatra.github.io/Type\nهنا يمكننا تجربة عدة Objects وفحص الذاكرة وملاحظة ماذكرته:\n  الصورة بحجم أكبر من هنا    1: العناوين للـ Objects\n  2: عند طباعة محتوى الذاكرة لـ Object a نلاحظ التالي:\n 2.1: عنوان الـ vtable ولو فحصناه سنجد عناوين لعدة functions تابعة للـ Object 2.2: عنوان الـ Type 2.3: الـ JSValue للرقم الذي وضعناه في x Integer 2.4: الـ JSValue للرقم الذي وضعناه في y Float (يمكنك عمل XOR له كما ذكرنا سابقآ وثم تحويله لـ Decimal للتأكد ) أيضا نلاحظ أن الـ Values موجودين مباشرة بعد الـ Type مما يعني أن الـ Object يستخدم inline slots بدلآ من auxSlots والسبب هو وضعنا للـ values مباشرة في سطر واحد.    2: عند طباعة محتوى الذاكرة لـ Object b نلاحظ التالي:\n 2.5: عنوان الـ vtable 2.6: عنوان الـ Type وهو نفسه عنواه الـ Type لـ Object a نظرآ لأنهم بنفس الـ structure والـ keys وأنواع المتغيرات 2.7: نلاحظ هذه المرة أن الـ Values ليست inline إنما يوجد عنوان يشير الى auxSlot وعند فحصنا نجد التالي:  2.8: الـ JSValue للرقم في x 2.9: الـ JSValue للرقم في y      عند طباعة محتوى الذاكرة لـ Object c نلاحظ التالي:\n 2.10: عنوان الـ vtable 2.11: عنوان الـ Type وهذه المرة العنوان إختلف نظرآ لإختلاف تركيبة هذا الـ Object عن البقية. 2.12 \u0026 2.13: الـ JSValues 2.14: عنوان يشير للـ String  بعد هذه الملاحظات والتجارب أصبح لدينا فهم بشكل مبسط عن كيف يعمل المحرك في تخزين البيانات الأساسية. توجد عدة متغيرات إخرى وإيضا يمكنك دراسة الـ Objects بشكل مفصل كالـ function objects, والـ arrays وغيرها. كل ماكان لديك معلومات أكثر كل ما إزدادت إمكانياتك في إكتشاف وإستغلال ثغرات المحرك.\n  الختام في ختام المقالة الإولى من هذه السلسلة; اتمنى أن تكون مقدمة كافية ومؤسسة لطريق أي شخص مهتم في هذا المجال ويرغب بالتعمق فيه. بدوري أعتبر هذه المقالة تدوين لي وتثبيت للمعلومات.\nالمقالة القادمة: لم أتطرق لأي إستغلالات في هذه المقالة لأنه لابد من معرفة الأساسيات. في المقالة القادمة سأتعمق في آلية عمل الـ FullJIT وكيف يمكن إستغلال الـ Optimizations فيه والنظر في عدد من الثغرات السابقة.\n عدد من المواضيع مختصرة بشكل كبير في المقالة يمكنك الإطلاع عليها بعض من المصادر المستخدمة: http://13.58.107.157/archives/7277 https://abchatra.github.io/TaggedFloat/ https://zhuanlan.zhihu.com/p/20792855 https://www.youtube.com/watch?v=lBL4KGIybWE\u0026list=LLWXClLvEAFlcXQnHnfraTLQ https://github.com/microsoft/ChakraCore/wiki/Architecture-Overview https://github.com/microsoft/ChakraCore/wiki/ChakraCore-Code-Structure\n ","wordCount":"1938","inLanguage":"en","image":"https://wes4m.io/%3Cimage%20path/url%3E","datePublished":"2019-11-25T04:51:01-07:00","dateModified":"2019-11-25T04:51:01-07:00","author":{"@type":"Person","name":"wes4m"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wes4m.io/posts/browser_exploitation/"},"publisher":{"@type":"Organization","name":"wes4m","logo":{"@type":"ImageObject","url":"https://wes4m.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://wes4m.io/ accesskey=h title="./ (Alt + H)">./</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=https://wes4m.io/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://wes4m.io/>Home</a>&nbsp;»&nbsp;<a href=https://wes4m.io/posts/>Posts</a></div>
<h1 class=post-title dir=rtl>
إستغلال ثغرات المتصفح | Webbrowser exploitation
</h1>
<div class=post-description dir=rtl>
Part 1
</div>
<div class=post-meta dir=rtl><span title="2019-11-25 04:51:01 -0700 -0700">November 25, 2019</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;wes4m&nbsp;|&nbsp;<a href=https://github.com/wes4m/wes4m.github.io/tree/drafting/content/posts/browser_exploitation.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<div class=post-content dir=rtl><blockquote>
<p>تنويه: إستغلال ثغرات المتصفحات ليس من إختصاصي إنما هذه السلسلة عبارة عن تدوين مستمر لطريقي في خوض هذا المجال وتعزيز لفهمي. أي اغلاط او اضافات أكون شاكر لكم.
ملاحظة: إطلاع سابق وفهم كيفية عمل لغات البرمجة. والـ Interpreters بشكل سطحي مهمة جدآ لهذا الموضوع.</p>
</blockquote>
<p>قبل الخوض في إستغلال ثغرات المتصفحات يجب أن نكون على إطلاع بأن المتصفحات في هذا الوقت أصبحت من أضخم وأهم البرمجيات قد توازي في تعقيدها أنظمة التشغيل نظرآ لتكونها من عناصر عديدة مترابطة ومعقدة. وكل ما إزداد التعقيد وحجم الكود برمجيآ كل ما إتسع الـ Attack surface.
فعلى سبيل المثال عندما ترغب بالعثور على ثغرة وإستغلالها في نظام تشغيل ما. يجب عليك تحديد نظام التشغيل ومن ثم تحديد الجزء الذي ترغب في تحليله ودراسته للعثور على ثغرات. كذلك في المتصفحات.</p>
<p>يتكون المتصفح في هذا الوقت من عدة أجزاء Components أهمها ( ليست محصورة ) :</p>
<ul>
<li>UI: واجهة المستخدم</li>
<li>Renderer engine: فلابد من جزء مسؤول عن تحويل أكواد الصفحات من عدة لغات مثل html, css لكي يراها المستخدم.</li>
<li>Networking: الجزء المسؤول عن كل مايتعلق بالشبكة وإرسال الطلبات وغيرها.</li>
<li>Javascript engine: المحرك المسؤول عن كل مايتعلق بالـ Javascript وتنفيذها للمستخدم.</li>
<li>Sandboxing. IPC: من أهم الاجزاء التي تعتبر جزء مسؤول عن حماية المستخدم حتى بعد وجود ثغرات.</li>
<li>وغيرها الكثير ..</li>
</ul>
<p>كل جزء يعتبر ضخم ومتفرع جدآ وقابل للإستغلال بشكل أو بآخر. ويوجد من يكرس كامل دراسته في جزء واحد فقط من هذه الأجزاء.
في هذه السلسلة سيكون تركيزي على الـ Javascript engine وكيفية إستغلال ثغراته.</p>
<p>توجد عدة متصفحات ولكل متصفح الـ Javascript engine الخاص به عادتآ.
أمثلة على ذلك:</p>
<ul>
<li>Safari: JavascriptCore</li>
<li>Google Chrome: V8</li>
<li>Microsoft Edge: ChakraCore</li>
<li>Firefox: SpiderMonkey</li>
</ul>
<h2 id=مقدمة-عن-javascript-engines>مقدمة عن Javascript engines<a hidden class=anchor aria-hidden=true href=#مقدمة-عن-javascript-engines>#</a></h2>
<p>هل سبق وسألت نفسك كيف يقوم المتصفح بتنفيذ أكواد الـ javascript بسرعة عالية ؟ ومدى أهمية السرعة في المتصفحات
أو لماذا لايقوم مصممي المواقع بعمل Compile لأكواد الـ javascript وتضمينها مع صفحاتهم.</p>
<p>توجد عدة أسباب أهمها الحجم، السرعة، والحرية في التواصل مع العناصر الإخرى في الصفحة إن صح التعبير.
فعادتآ اكواد الجافاسكربت مرتبطة بالـ DOM في الصفحة وتتعامل مع الـ Renderer engine لإضافة نصوص وقرائتها والحصول على معطيات من المستخدم وربطها بـ Events كضغط أزرار أو تغيير اللوان CSS وغيرها من ترابطات بين كل أجزاء الصفحة.</p>
<p>يمكنك دراسة الـ Javascript engine بشكل عام والقراءة عنه وغيره .. لكن لإستغلاله لابد من إختيار محرك محدد والتعمق فيه. وقع إختياري على <code>ChakreCore</code> مفتوح المصدر ومن هنا تبدأ الرحلة.</p>
<h2 id=chakracore>ChakraCore<a hidden class=anchor aria-hidden=true href=#chakracore>#</a></h2>
<p><a href=https://github.com/microsoft>ChakraCore</a> هو أساس محرك Chakra وهو الجزء المسؤول عن الـ javascript في متصفح Microsoft Edge
يتكون المحرك من عدة أجزاء قابلة للإستغلال ومعقدة كذلك ولكن سيكون تركيزي على جزء واحد فقط.</p>
<p><img loading=lazy src=https://github.com/microsoft/ChakraCore/wiki/images/chakracore_componentization.png alt="enter image description here">
</p>
<p>الجافاسكربت هي لغة برمجة كغيرها من اللغات فلو قمت بدراسة كيف تعمل لغة برمجة بشكل مبسط سترى أنك بحاجة الى Parser يقوم بتحويل الكود المكتوب الى <code>Abstract Syntax Tree - AST</code> يمكنك التعمق في هذا الموضوع (يدرس عادتآ في كلاسات علوم الكمبيوتر)
ومن ثم على حسب نمط اللغة ستحتاج الى <code>Interpret/Compiler</code> أو الاثنان معآ.</p>
<p>بالإضافة لذلك تجد في الصورة عدة أجزاء إضافية مثل Garbage collector الجزء المسؤول عن تنظيف الذاكرة بشكل تلقائي. على عكس لغات إخرى قد لاتحتوي على هذا الجزء مثل C. وكل جزء من هذه الأجزاء أيضآ معقد ويتفرع بداخله لعدة أجزاء.</p>
<p>بإختصار شديد، فور فتحك لصفحة تحتوي على أكواد جافاسكربت يبدأ المحرك بالعمل وقراءة الكود قبل حتى أن تعرض الصفحة لك</p>
<h3 id=execution-pipeline-مسار-تنفيذ-الـ-javascript-في-chakracore>(Execution Pipeline) مسار تنفيذ الـ Javascript في ChakraCore:<a hidden class=anchor aria-hidden=true href=#execution-pipeline-مسار-تنفيذ-الـ-javascript-في-chakracore>#</a></h3>
<p><img loading=lazy src=https://github.com/microsoft/ChakraCore/wiki/images/chakracore_pipeline.png alt>
</p>
<h4 id=الخطوة-الإولى>الخطوة الإولى:<a hidden class=anchor aria-hidden=true href=#الخطوة-الإولى>#</a></h4>
<p>تحويل الكود الى <code>AST</code> يقوم بفهمها الـ <code>Bytecode generator</code> فهذه هي طريقة عمل لغة برمجة الجافا بشكل عام. يتم تحويل الكود الـ <code>Bytecode</code> تستطيع فهمه الـ <code>Java virtual machine - JVM</code> وتنفيذه.</p>
<h4 id=الخطوة-الثانية>الخطوة الثانية:<a hidden class=anchor aria-hidden=true href=#الخطوة-الثانية>#</a></h4>
<p>يقوم الـ <code>Interpreter</code> بتنفيذ أو الأصح <code>Interpret</code> للـ <code>Bytecode</code> في ثريد منفصل وأثناء تنفيذه يقوم بجمع معلومات عن كل سطر يقوم بتنفيذه ومن هنا يأتي مصطلح <code>Profiling</code> المضاف في الصورة.
على سبيل المثال كما تعلم ففي الجافاسكربت يمكنك إسناد رقم الى متغير أو نص بدون تحديد نوع المتغير فهنا يأتي دور الـ <code>Profiler</code> فيقوم بتخزين المعلومة أن المتغير من نوع <code>Integer </code> على سبيل المثال. وكذلك غيرها من المعلومات.</p>
<h4 id=الخطوة-الثالثة>الخطوة الثالثة:<a hidden class=anchor aria-hidden=true href=#الخطوة-الثالثة>#</a></h4>
<p>كما تحدثنا سابقآ فأهم عنصر في الجافاسكربت هي السرعة. المستخدم يريد أن تعمل الصفحة بسلاسة وتتحمل بأسرع وقت ممكن
هنا يأتي دور الـ <code>Just In time compiler - JIT</code> وهو الجزء الذي سيكون كامل تركيزي عليه.</p>
<p>ماهو <code>JIT</code> ؟
هو جزء مسؤول عن إستخدام المعلومات المجموعة عن طريق الـ <code>Profiling Interpreter</code> وإستخدامها في صالح عمل <code>Optimization</code> للكود. بحيث يتم تنفيذه بشكل أسرع.
للعلم أنه يمكنك عمل compile للجافاسكربت <code>Ahead of time - AOT</code> كغيرها من اللغات.
ولكن الضعف في عمل compile مسبق بأن الكود سيصبح بطيئ وضخم نظرآ للتحققات التي يجب أن تضاف قبل كل سطر على سبيل المثال إسناد متغير ومن ثم جمعه مع متغير آخر</p>
<script src=https://gist.github.com/wes4m/906897cc4281df061e810e2788f61170.js></script>
<p>قد ترى الكود بسيط ولكن في الخلفية وعند تحويل الكود الى <code>Machine code</code> إضافة رقم الى رقم ليس كإضافة نص الى رقم.
لنفرض أن <code>b = 2</code> غيرناه الى رقم بدل عن نص. كيف يمكن للـ <code>Interpreter</code> معرفة ذلك بدون وضع تعليمات إضافية للتحقق من كل متغير قبل تنفيذ عمليات عليه. ومن هذا المنطلق تأتي الحاجة للـ <code>Optimization</code> خصوصا لو كانت عملية مكررة كحلقات التكرار.
فالتعليمات الإضافية للتحقق من نوع المتغير أو حجم مصفوفة أو غيره الكثير من الحالات تؤدي الى بطئ وإضاعة وقت و موارد الجهاز
وهذا الإهذار يعتبر عدو من أعداء علماء الكمبيوتر فالكثير الكثير من الخوارزميات والتكنلوجيا كانت نتيجة عن بحوث في الـ <code>Optimization</code></p>
<p>وفي حالة الـ javascript engines هنا يولد الـ <code>JIT</code>
فبإستخدام المعلومات من الـ <code>Profiling</code> يمكن للـ <code>JIT</code> إستنباط إمور كثيرة كنوع المتغير، حجمه، حجم المصفوفات والـ Objects وانواعهم وغيرها الكثير من الامور ..
بإستنباط هذه المعلومات يمكنه إتخاد قرار على سبيل المثال أن الكود يقوم بتنفيذ حلقة تكرار ويضيف متغيرين من نوع <code>Integer</code> في كل مرة. فبدوره يقوم بإنتاج <code>Machine code</code> لايقوم بالتحقق من نوع المتغير في كل مرة فيكفي التحقق مرة واحدة ومن ثم تنفيذ الكود.
هذا أحد الأمثلة على عمل <code>Optimization</code> وتسريع الكود.
قد يفشل التحقق الأول وبدوره يعود الى الكود السابق الأساسي في عملية تسمى <code>Bail out</code>.
ولكن أيضا قد يفشل بشكل غير متوقع أو مقصود ( وهنا تكمن الثغرات، فيمكنك إستغلال عدة أنواع ثغرات في الـ <code>JIT</code> )</p>
<p>كما نرى في الصورة ينقسم الـ <code>JIT</code> في ChakraCore الى قسمين <code>SimpleJIT</code> و <code>FullJIT</code> كل جزء مسؤول عن عمل <code>Optimization</code> ولكن الـ <code>FullJIT</code> هو الجزء الأهم في المحرك نظرآ لأنه يقوم بعمل الجزء الاكبر والاكثر تعقيدآ من التغييرات وسيكون تركيزي متمحور حوله بشكل كامل. ولكن قبل ذلك لابد من التعمق بشكل أكبر في ChakraCore</p>
<blockquote>
<p>ملاحظة قد تختلف المسميات لأجزاء كل محرك ويختلف الـ implementation ولكن بشكل عام التشابه كبير والوظيفة واحدة.
على سبيل المثال الـ JIT في محرك قوقل كروم V8 يسمي TurboFan</p>
</blockquote>
<h3 id=بعض-المعلومات-المهمة-في-chakracore>بعض المعلومات المهمة في ChakraCore<a hidden class=anchor aria-hidden=true href=#بعض-المعلومات-المهمة-في-chakracore>#</a></h3>
<p>لايمكننا الخوض في طريقة عمل الـ <code>JIT</code> وكيفية إستغلاله قبل أن نعرف عدة إمور منها كيف يقوم ChakraCore بتخزين البيانات من Values, Objects وغيرها في الذاكرة.
فتحدثت سابقآ أنه لابد من التحقق من المتغيرات قبل تنفيذ عملية عليها نظرآ لإختلاف طريقة تنفيذ العمليات والتعامل مع values من أنواع مختلفة.</p>
<p>قمت بتحميل ChakraCore على Linux من هنا: <a href=https://github.com/microsoft/ChakraCore>https://github.com/microsoft/ChakraCore</a>
وعمل build له للبدء في التعمق فيه وفهم بعض من طرق عمله.</p>
<blockquote>
<p>بعض المحركات الإخرى مثل JavascriptCore نوعآ ما أسهل في عمل debugging والتعمق فيها بسبب توفر عدة functions و interactive cli له.</p>
<p>كذلك سأقوم بإستخدام gdb على linux لأنها الـ environment المفضلة لدي قد أكون صعبت على نفسي العملية</p>
</blockquote>
<blockquote>
<p>إستخدام windbg وتحميل المحرك على windows لربما يكون أسهل في التعامل معه. بما معناه: لاتتابعني إستخدم ويندوز أسهل 🤗</p>
</blockquote>
<h4 id=إضافة-functions-للسورس-تساعد-على-عمل-debugging>إضافة functions للسورس تساعد على عمل debugging<a hidden class=anchor aria-hidden=true href=#إضافة-functions-للسورس-تساعد-على-عمل-debugging>#</a></h4>
<p>قمت بإضافة بعض الfunctions لسورس المحرك لتسهيل فحص الذاكرة وإضافة breakpoints</p>
<script src=https://gist.github.com/wes4m/063ef2e6ddd64ab039135dfe974d8715.js></script>
<script src=https://gist.github.com/wes4m/3d1542edeaec06a46a44c8f392d03518.js></script>
<script src=https://gist.github.com/wes4m/c7ba57f4699eb7b5d2d7dd9462a501f0.js></script>
<p>بعد الإضافة وعمل build يمكن إستخدام الـ functions في كود الجافاسكربت وتشغيله عن طريق الـ <code>ch</code> بإستخدام gdb على سبيل المثال</p>
<script src=https://gist.github.com/wes4m/cb1b54005b6ad93e9d85c3475cd4e6bc.js></script>
<p>الملف الناتج <code>ch</code> في <code>out/Debug/ch</code> يحتوي على إمكانيات كثيرة جدآ من ضمنها طباعة الكود بعد <code>Phase</code> محدد في المحرك
على سبيل المثال يمكنه عرض الكود بعد تحويله الى ByteCode عن طريق الأمر</p>
<pre tabindex=0><code>ch -dump:Bytecode test.js
</code></pre><p>كذلك تعطيل <code>Phase</code> محدد وطباعة بعض العنوانين عن طريق</p>
<script src=https://gist.github.com/wes4m/c14b01b90aa29c1fe005431cec36e808.js></script>
<p>وغيرها الكثير ..</p>
<h3 id=jsvalues>JSValues<a hidden class=anchor aria-hidden=true href=#jsvalues>#</a></h3>
<p>لنرى كيف يقوم المحرك بتخزين بعض البيانات في الذاكرة. بدئآ بـ <code>Integers</code></p>
<script src=https://gist.github.com/wes4m/e81b73deb9ce8f08a66cfaffcbb5d021.js></script>
<p>قمت بطباعة الـ ByteCode وأيضا تتبع الـ <code>Interpreter</code> في gdb وكانت هذه الملاحظات:</p>
<p><img loading=lazy src=/images/wbbx-1.png alt=gdb1>
</p>
<center>
الصورة بحجم أكبر من <a href=wbbx-1.png>هنا</a>
</center>
<p>الملاحظات:</p>
<ul>
<li>1: نرى أن الرقم 0x414141 يتم تخزينه كثابت const في R3 عن طريق <code>LdC_A_I4</code> ويبدوا أنه I4 ترمز الى <code>integer</code> من أربع بايتات</li>
<li>2: يتم إسناد الثابت من R3 الى المتغير root.a وهو المتغير في الكود عن طريق <code>ProfiledStRootFld</code></li>
<li>3: عن طريق تتبع الـ <code>Interpreter</code> وصولآ الى التعليمة <code>ProfiledStRootFld</code> وتتبعها ستلاحظ أن الرقم سيظهر في <code>RSI</code> وثم يتم نقله الى عنوان بالذاكرة وهو عنوان المتغير.
ولكن ستلاحظ أيضا أن الرقم أصبح بهذا الشكل:</li>
</ul>
<pre tabindex=0><code>0x 00 01 00 00 00 41 41 41
</code></pre><p>ولو تركنا الكود يكمل تنفيذه سنرى النتيجة كالتالي أيضآ</p>
<pre tabindex=0><code>Address/val 1th arg: 0x1000000414141
</code></pre><p>مما يأكد النتيجة. مما يعني أن المحرك يقوم بتخزين الرقم في الاربع بايتات السفلية ويقوم بإستخدام <code>0x00010000</code> في الاربع بياتات العلوية كمعلومة أن هذا المتغير من نوع Integer</p>
<p>عند تجربة <code>NULL</code> ستلاحظ أن النتيجة <code>0x0000000000000000</code>
عند التجربة على <code>float</code> النتيجة مختلفة قليلآ قد يبدو أنك لاتجد الرقم الذي وضعته ولكن مايحدث هو أن المحرك يقوم بعمل <code>XOR</code> للـ <code>float</code> المدخل مع <code>0xfffc000000000000</code>. وتوجد بعض المعلومات الإخرى كـ infinity و -infinity ولهم رقم خاص يمكنك الإطلاع على هذا الموضوع لمعرفة أكثر عن الـ <code>floats</code> في ChakraCore:</p>
<p><a href=https://abchatra.github.io/TaggedFloat>https://abchatra.github.io/TaggedFloat</a></p>
<p>وبهذه الآلية والتجربة يمكنك ملاحظة بقية أنواع المتغيرات.</p>
<h3 id=jsobjects>JSObjects<a hidden class=anchor aria-hidden=true href=#jsobjects>#</a></h3>
<p>في الجافاسكربت أغلب ماتتعامل معه هو عبارة عن Object حتى الـ functions
فأي عنصر ليس</p>
<p><code>Primitive type - undefined, null, number, string, boolean</code> فهو Object</p>
<p>من سورس كود المحرك نرى أن الـ Object في الذاكرة يكون بهذا الشكل<code>DynamicObject.h</code></p>
<script src=https://gist.github.com/wes4m/250cca30e8ea7b318b669ccd40bc6809.js></script>
<p>حاليآ لايهمنا سوى الـ <code>auxSlots</code>, <code>inline slots</code>
فالـ Objects في الجافاسكربت لايتم تخزين الـ keys التابعة لها في الاوبجكت نفسه بل يتم تخزينه كـ <code>Type</code> يمكن إستخدامه عن طريق عدة Objects ويتم إدارته عن طريق الـ <code>DynamicTypeHandler</code>
الـ <code>type</code> يوجد مباشرة بعد عنوان الـ <code>vtable</code></p>
<p>صورة توضيحية:
<img loading=lazy src=https://abchatra.github.io/images/2015-12-22-Type-ObjectLayout-sharing.png alt="enter image description here">
لمعلومات أكثر عن الـ <code>Type</code> في ChakraCore:
<a href=https://abchatra.github.io/Type>https://abchatra.github.io/Type</a></p>
<p>هنا يمكننا تجربة عدة Objects وفحص الذاكرة وملاحظة ماذكرته:</p>
<script src=https://gist.github.com/wes4m/3c0bb1a9029677fcb3bb089a62c004ba.js></script>
<p><img loading=lazy src=/images/wbbx-2.png alt=gdb2>
</p>
<center>
الصورة بحجم أكبر من <a href=wbbx-2.png>هنا</a>
</center>
<ul>
<li>
<p>1: العناوين للـ Objects</p>
</li>
<li>
<p>2: عند طباعة محتوى الذاكرة لـ Object a نلاحظ التالي:</p>
<ul>
<li>2.1: عنوان الـ vtable ولو فحصناه سنجد عناوين لعدة functions تابعة للـ Object</li>
<li>2.2: عنوان الـ <code>Type</code></li>
<li>2.3: الـ JSValue للرقم الذي وضعناه في x <code>Integer</code></li>
<li>2.4: الـ JSValue للرقم الذي وضعناه في y <code>Float</code> (يمكنك عمل XOR له كما ذكرنا سابقآ وثم تحويله لـ Decimal للتأكد )</li>
<li>أيضا نلاحظ أن الـ Values موجودين مباشرة بعد الـ <code>Type</code> مما يعني أن الـ Object يستخدم <code>inline slots</code> بدلآ من <code>auxSlots</code> والسبب هو وضعنا للـ values مباشرة في سطر واحد.</li>
</ul>
</li>
<li>
<p>2: عند طباعة محتوى الذاكرة لـ Object b نلاحظ التالي:</p>
<ul>
<li>2.5: عنوان الـ vtable</li>
<li>2.6: عنوان الـ <code>Type</code> وهو نفسه عنواه الـ <code>Type</code> لـ Object a نظرآ لأنهم بنفس الـ structure والـ keys وأنواع المتغيرات</li>
<li>2.7: نلاحظ هذه المرة أن الـ Values ليست inline إنما يوجد عنوان يشير الى <code>auxSlot</code> وعند فحصنا نجد التالي:
<ul>
<li>2.8: الـ JSValue للرقم في x</li>
<li>2.9: الـ JSValue للرقم في y</li>
</ul>
</li>
</ul>
</li>
<li>
<p>عند طباعة محتوى الذاكرة لـ Object c نلاحظ التالي:</p>
<ul>
<li>2.10: عنوان الـ vtable</li>
<li>2.11: عنوان الـ <code>Type</code> وهذه المرة العنوان إختلف نظرآ لإختلاف تركيبة هذا الـ Object عن البقية.</li>
<li>2.12 & 2.13: الـ JSValues</li>
<li>2.14: عنوان يشير للـ String</li>
</ul>
<p>بعد هذه الملاحظات والتجارب أصبح لدينا فهم بشكل مبسط عن كيف يعمل المحرك في تخزين البيانات الأساسية. توجد عدة متغيرات إخرى وإيضا يمكنك دراسة الـ Objects بشكل مفصل كالـ function objects, والـ arrays وغيرها. كل ماكان لديك معلومات أكثر كل ما إزدادت إمكانياتك في إكتشاف وإستغلال ثغرات المحرك.</p>
</li>
</ul>
<h2 id=الختام>الختام<a hidden class=anchor aria-hidden=true href=#الختام>#</a></h2>
<p>في ختام المقالة الإولى من هذه السلسلة; اتمنى أن تكون مقدمة كافية ومؤسسة لطريق أي شخص مهتم في هذا المجال ويرغب بالتعمق فيه. بدوري أعتبر هذه المقالة تدوين لي وتثبيت للمعلومات.</p>
<h3 id=المقالة-القادمة>المقالة القادمة:<a hidden class=anchor aria-hidden=true href=#المقالة-القادمة>#</a></h3>
<p>لم أتطرق لأي إستغلالات في هذه المقالة لأنه لابد من معرفة الأساسيات.
في المقالة القادمة سأتعمق في آلية عمل الـ <code>FullJIT</code> وكيف يمكن إستغلال الـ <code>Optimizations</code> فيه والنظر في عدد من الثغرات السابقة.</p>
<blockquote>
<p>عدد من المواضيع مختصرة بشكل كبير في المقالة يمكنك الإطلاع عليها بعض من المصادر المستخدمة:
<a href=http://13.58.107.157/archives/7277>http://13.58.107.157/archives/7277</a>
<a href=https://abchatra.github.io/TaggedFloat/>https://abchatra.github.io/TaggedFloat/</a>
<a href=https://zhuanlan.zhihu.com/p/20792855>https://zhuanlan.zhihu.com/p/20792855</a>
<a href="https://www.youtube.com/watch?v=lBL4KGIybWE&list=LLWXClLvEAFlcXQnHnfraTLQ">https://www.youtube.com/watch?v=lBL4KGIybWE&list=LLWXClLvEAFlcXQnHnfraTLQ</a>
<a href=https://github.com/microsoft/ChakraCore/wiki/Architecture-Overview>https://github.com/microsoft/ChakraCore/wiki/Architecture-Overview</a>
<a href=https://github.com/microsoft/ChakraCore/wiki/ChakraCore-Code-Structure>https://github.com/microsoft/ChakraCore/wiki/ChakraCore-Code-Structure</a></p>
</blockquote>
</div>
<footer class=post-footer>
<ul class=post-tags dir=rtl>
<li><a href=https://wes4m.io/tags/misc/>Misc</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://wes4m.io/posts/random_fun/>
<span class=title>« Prev</span>
<br>
<span>Fuzzing, Emulation, and Random low-level fun #1</span>
</a>
<a class=next href=https://wes4m.io/posts/kernel_exploitation/>
<span class=title>Next »</span>
<br>
<span>إستغلال ثغرات النواة | Kernel exploitation</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2025 <a href=https://wes4m.io/>wes4m</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>